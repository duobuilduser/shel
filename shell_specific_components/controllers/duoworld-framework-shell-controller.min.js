!function(){var e=function(e,o,n,t,i,l,c,r,s,p,u,d,m,g,f,h,w,v,y){function A(n){var t=1,i=0;for(a=0;a<n.length;a++)n[a].col=i,n[a].row=t,i+=1,5==i&&(t+=1,i=0);o.allApps=n,e.allApps=n,console.log(e.allApps)}function _(e,o,n){e.data=n,e.confirm=function(){o.hide(!0)},e.deny=function(){o.hide(!1)}}$(".systemTrayScroller").perfectScrollbar({wheelSpeed:2,wheelPropagation:!0,minScrollbarLength:20,suppressScrollX:!0});var S=!1;e.shellConfig={},o.selectedTennantID=document.domain,e.frameworkShellSecurityToken="",e.dwFrameworkActiveApps=[],e.recivedTennantCollection=[],o.allApps=[],e.frameworkFavoriteApplication=[],e.currenttenantsessioninfo=[],e.shellUserProfileSection=[],e.v6urls=d,e.opendAppIconUrl="",e.panelCustomizingTray=!1;var C=function(){S=p.checkSession()?!0:!1};C();var b=function(){e.currenttenantsessioninfo=p.getSession()};b();var T=function(){S===!0?(n.go("dock"),e.frameworkShellSecurityToken=p.getSecurityToken()):n.go("unrecognized")};T();var P=function(){o.getProfilePicture(),s.setOnline(),t.get("http://"+window.location.hostname+"/auth/GetSession/"+p.getSecurityToken()+"/"+window.location.hostname).success(function(n){o.authObject=n,t.get("/apis/profile/userprofile/"+o.authObject.Email).success(function(n){o.content=n,e.content=n}).error(function(o){e.content=o})}).error(function(e){})};o.getProfilePicture=function(){e.profilePicture=y.getMediaUrl("profilepictures","profile.jpg")},P();var k=function(){t.get("shell_specific_components/local_data/shellconfiguration.json").success(function(o,n,t,i){e.shellConfig=o}).error(function(e,o,n,t){})},N=function(){e.shellConfig.username=p.getUserName();var o=g.getClient("shellconfig");o.onComplete(function(e){}),o.onError(function(e){}),o.insert(e.shellConfig,{KeyProperty:"username"})},D=function(){console.log("loading shellconfig from objectstore");var n=g.getClient("shellconfig");n.onGetOne(function(n,t,i,a){void 0===n.docklayoutconfiguration?(k(),N()):(e.shellConfig=n,o.panels=e.shellConfig.docklayoutconfiguration.pannelcollection)}),n.onError(function(e,o,n,t){k()}),n.getByKey(p.getUserName())};D(),o.globalTenantRetrivel=function(){t.get(e.v6urls.auth+"/tenant/GetTenants/"+e.frameworkShellSecurityToken).success(function(o,n,t,i){e.recivedTennantCollection=o}).error(function(e,o,n,t){})},o.globalTenantRetrivel(),o.globalAppRetrivel=function(){u.onAppsRetrieved(function(e,n){var t=window.location.hostname;for(var i in n.apps){var a=n.apps[i].iconUrl;a?0===a.indexOf("http")?n.apps[i].iconUrl=a:n.apps[i].iconUrl=window.location.protocol+"//"+t+a:n.apps[i].iconUrl="/devportal/appicons/29fa48d1ffbb1f3792a417cda647df7d.png"}o.allApps=n.apps,A(o.allApps)}),u.getAppsForUser()},o.globalAppRetrivel(),o.switchTennant=function(){},o.toggleLeftMenu=function(){l("left").toggle()},o.toggleNotifications=function(){l("right").toggle(),e.rightNavContent="notifications"},o.returnHome=function(){o.toggleLeftMenu(),i.path("/")},o.quickLaunchAppAccess=function(n){o.toggleLeftMenu();var t="launcher/customapp/"+n.ApplicationID+"/"+n.Name;i.path(t),e.opendAppIconUrl=n.iconUrl},o.dwSwitchTennant=function(e,n){o.toggleRightMenu();var t=c.confirm().title("Tennant switch confirm.").content("Are you sure you want to switch to "+n+" ?").ariaLabel("Switch Tennant").ok("Yes go ahead !").cancel("Dont do it").targetEvent(e);c.show(t).then(function(){location.replace("http://"+n)},function(){})},o.dwFrameworkBuiltinAppNavigation=function(e){switch(e){case"market place":n.go("launcher.marketplace");break;case"user profile":n.go("launcher.userprofile");break;case"tennant explorer":n.go("launcher.tennantexplorer");break;case"settings":n.go("launcher.settings")}},o.dwFrameworkConnectAppNavigation=function(){n.go("duoworld-framework.launcher.connect")},o.appUninstall=function(e){g.getClient("application").onComplete(function(e){console.log(e)}).onError(function(e){console.log(e)})["delete"](e,{KeyProperty:"ApplicationID"})},o.quitApplication=function(o){e.showCustomConfirmDialog("icons/ic_exit_to_app_24px.svg","Quit Application","are you sure you want to continue?","do it!","oh no!",o).then(function(e){e&&location.replace("http://duoworld.com/logout.php")})},_.$inject=["$scope","$mdDialog","data"],e.showCustomConfirmDialog=function(e,o,n,t,i,a){var l=v.defer(),r={icon:e,title:o,content:n,okay:t,cancel:i};return c.show({template:'<md-dialog>                <div layout="row" style="width:100%;height:100%;height:200px;min-width:350px;background-color:{{$root.shellConfig.themeconfiguration.primarypalette}};color:whitesmoke;padding:15px;">            <div layout="row" layout-align="center center" style="height:100%;">            <md-icon md-svg-icon="{{data.icon}}" style="color:{{$root.shellConfig.themeconfiguration.accentpalette}};transform:scale(7); margin:0px;opacity: 1;" alt="switch tennants"></md-icon></div>                    <div layout="column" layout-align="center start" style="margin-left:20%;">                        <p style="font-size:34px;font-weight:300;margin:0px;">{{data.title}}</p>              <p style = "font-size:14px;font-weight:300;margin:5px;color: rgba(255, 255, 255, 0.6);">{{data.content}}</p><div style = "width:100%;" layout = "row" layout-align = "end center"><md-button style="color:{{$root.shellConfig.themeconfiguration.accentpalette}}" ng-click="confirm();">{{data.okay}} </md-button><md-button style="color:{{$root.shellConfig.themeconfiguration.accentpalette}}" ng-click="deny();">{{data.cancel}}</md-button></div></div></md-dialog>',parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0,locals:{data:r},controller:_}).then(function(e){1==e?l.resolve(!0):l.resolve(!1)},function(){}),l.promise},o.showTransition=!1,o.showPanelEditTray=function(e,n){o.panelCustomizingTray=!0,o.showTransition=!0,o.selectedPanel=n,o.originalPanel=angular.copy(o.selectedPanel),void 0==o.selectedPanel.panelComponents&&(o.selectedPanel.panelComponents=[])},o.$watch("selectedPanel",function(){},!0),o.addToPanel=function(n,t,i){for(var a=0;a<e.shellConfig.docklayoutconfiguration.pannelcollection.length;a++)e.shellConfig.docklayoutconfiguration.pannelcollection[a].panelTitle==i&&(o.selectedPanel=e.shellConfig.docklayoutconfiguration.pannelcollection[a]);if(void 0!==o.selectedPanel){var l={comp_Id:n.ApplicationID,comp_Name:n.Name,comp_Type:t,comp_Data:n,comp_extra:{visible:!0,row:n.row,col:n.col,sizeX:2,sizeY:1}};"appshortcut"!==t&&(l.comp_extra.sizeX=3,l.comp_extra.sizeY=2,l.comp_extra.widgetImage=n.image),o.selectedPanel.panelComponents.push(l)}},o.alreadyAddedValues=function(){return void 0!==o.selectedPanel?o.selectedPanel.panelComponents:void 0},o.filterAlreadyAdded=function(e){return void 0!==o.selectedPanel?-1==o.alreadyAddedValues().indexOf(e):void 0},o.closeCustomizingTray=function(){console.log("closing customizing tray"),o.showTransition=!1,f(function(){o.panelCustomizingTray=!1},400);for(var n=0;n<e.shellConfig.docklayoutconfiguration.pannelcollection.length;n++)e.shellConfig.docklayoutconfiguration.pannelcollection[n].panelTitle==o.selectedPanel.panelTitle&&(e.shellConfig.docklayoutconfiguration.pannelcollection[n]=o.selectedPanel);angular.equals(o.originalPanel,o.selectedPanel)||o.saveGlobalSettings()},o.gridsterOpts={columns:12,pushing:!0,floating:!1,swapping:!0,width:"auto",colWidth:"auto",rowHeight:200,outerMargin:!0,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:5,minRows:4,maxRows:4,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:100,resizable:{enabled:!1},draggable:{enabled:!0}},o.collectionpanelOpts={columns:12,width:"auto",colWidth:"auto",rowHeight:200,outerMargin:!0,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:5,minRows:4,maxRows:4,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:100,resizable:{enabled:!1},draggable:{enabled:!1}},o.customItemMap={sizeX:"app.comp_extra.sizeX",sizeY:"app.comp_extra.sizeY",row:"app.comp_extra.row",col:"app.comp_extra.col"},o.widgetItemMap={sizeX:"componentdata.comp_extra.sizeX",sizeY:"componentdata.comp_extra.sizeY",row:"componentdata.comp_extra.row",col:"componentdata.comp_extra.col"},o.saveGlobalSettings=function(){e.shellConfig.username=p.getUserName();var o=g.getClient("shellconfig");o.onComplete(function(e){r.show(r.simple().content("Changes have been saved !").hideDelay(3e3))}),o.onError(function(e){r.show(r.simple().content("Something went wrong!").hideDelay(3e3))}),o.insert(e.shellConfig,{KeyProperty:"username"})},o.removeAppFromPanel=function(e,n){var t=c.confirm().title("Would you like to delete "+e.comp_Name+" ?").textContent("the app will be removed from your collections").ariaLabel("Lucky day").targetEvent(n).ok("Please do it!").cancel("Dont do it!");c.show(t).then(function(){for(var n=0;n<o.selectedPanel.panelComponents.length;n++)if(e.comp_Id==o.selectedPanel.panelComponents[n].comp_Id)var t=n;console.log(o.selectedPanel.panelComponents,t),o.selectedPanel.panelComponents.splice(t,1),r.show(r.simple().content(e.comp_Name+" deleted").position("top right").hideDelay(2e3))},function(){})},o.handleDrop=function(e){console.log("adding it to panel");var n=JSON.parse(e.dataTransfer.getData("Panel")),t=JSON.parse(e.dataTransfer.getData("Text"));console.log(t),void 0!==t.ApplicationID?o.addToPanel(t,"appshortcut",n):(t.ApplicationID=t.Name+new Date,o.addToPanel(t,t.Name,n))},o.goToNextStep=function(){var e=document.getElementById("appTray-content");e.scrollTop+=90},o.goToPrevStep=function(){var e=document.getElementById("appTray-content");e.scrollTop+=90},o.searchBarRevealed=!1,o.revealSearchBar=function(){o.searchBarRevealed=!o.searchBarRevealed,o.globalSearchKeyword=""},e.runningApps=[],o.switchApp=function(o){if(o.appLocation.match(/customapp.*/)){var t="";t=o.appLocation.slice(2),e.removeFromRunningApp(o.appLocation),e.addToRunningApp(),i.path(t)}else{var t="";t=o.appLocation.slice(2),t=t.replace(/\//g,"."),e.removeFromRunningApp(o.appLocation),e.addToRunningApp(),n.go(t)}},e.addToRunningApp=function(o,n){for(var t=window.location.hash,i=0;i<e.runningApps.length;i++)e.runningApps[i].appLocation==t&&e.runningApps.splice(i,1);var a={appName:o,appLocation:t,imageUrl:n};"#/dock"==a.appLocation||e.runningApps.push(a)},e.removeFromRunningApp=function(o){for(var n=0;n<e.runningApps.length;n++)o==e.runningApps[n].appLocation&&e.runningApps.splice(n,1)},o.allWidgets=[{Name:"clock",image:"images/widget/clock.png",color:"lime",icon:"ic_watch_24px.svg"},{Name:"weather",image:"images/widget/weather.png",color:"yellow",icon:"ic_cloud_24px.svg"},{Name:"userprofile",image:"images/widget/profile.png",color:"red",icon:"ic_person_24px.svg"},{Name:"calender",image:"images/widget/calender.png",color:"blue",icon:"ic_timer_24px.svg"}],o.unseenNotificationCount=0,o.shellNotifications=[];var L=["blue","lime","purple","grey","red","teal","cyan","amber"],M=!1;o.showNotifications=function(e){e(),M=!M,M||o.removeAllSeenNotifications()},e.sendShellNotification=function(o){h.command("notification",{type:"shell",from:e.currenttenantsessioninfo.Username,to:e.currenttenantsessioninfo.Username,message:o})},e.sendBulkNotification=function(o){h.command("notification",{type:"tenantbulkshell",from:e.currenttenantsessioninfo.Username,message:o})},h.onRecieveCommand("notification_response",function(e,o){console.log(o)}),h.onRecieveCommand("send_notification",function(e,n){var t={from:n.from,timestamp:n.timestamp,message:n.content,viewstatus:!0,color:L[Math.floor(Math.random()*L.length)]};o.shellNotifications.push(t),o.unseenNotificationCount=o.unseenNotificationCount+1}),o.removeAllSeenNotifications=function(){for(var e=0;e<o.shellNotifications.length;e++)1==o.shellNotifications[e].viewstatus&&(o.shellNotifications[e].viewstatus=!1);o.unseenNotificationCount=0},o.isNotificationeEmpty=function(){for(var e=!0,n=0;n<o.shellNotifications.length;n++)1==o.shellNotifications[n].viewstatus&&(e=!1);return e},e.deleteApp=function(e){t.get("/apps/"+e.ApplicationID+"?unshare=true").success(function(n){console.log(n),o.globalAppRetrivel(),r.show(r.simple().content(e.Name+" uninstalled successfully!").position("right bottom").hideDelay(3e3))}).error(function(e){console.log(e),r.show(r.simple().content("couldnt uninstall").position("right bottom").hideDelay(3e3))})},o.appBundles=[{title:"Social media",icon:"images/appIcons/inventory.png",apps:[{$$hashKey:"object:55",AppType:"HTML5SDK",AppUri:"//",ApplicationID:"APP_SHELL_MY_ACCOUNT",Description:"My Account App",ImageId:"",Name:"My Account",SecretKey:"c23cc2d146e3f3b704adf132a8573163",__osHeaders:{},col:0,iconUrl:"http://jamesgmailcom.space.duoworld.com/devportal/appicons/APP_SHELL_MY_ACCOUNT.png",row:1},{$$hashKey:"object:56",AppType:"HTML5SDK",AppUri:"//",ApplicationID:"APP_SHELL_MY_REW",Description:"MEWR",ImageId:"",Name:"MyDSDnt",SecretKey:"c23cc2d146e3f3b704adf132a8573163",__osHeaders:{},col:0,iconUrl:"http://jamesgmailcom.space.duoworld.com/devportal/appicons/APP_SHELL_MY_ACCOUNT.png",row:1}]},{title:"Social mcdgsdg",icon:"images/appIcons/inventory.png",apps:[{$$hashKey:"object:55",AppType:"HTML5SDK",AppUri:"//",ApplicationID:"APP_SHELL_MY_ACCOUNT",Description:"My Account App",ImageId:"",Name:"My Account",SecretKey:"c23cc2d146e3f3b704adf132a8573163",__osHeaders:{},col:0,iconUrl:"http://jamesgmailcom.space.duoworld.com/devportal/appicons/APP_SHELL_MY_ACCOUNT.png",row:1},{$$hashKey:"object:56",AppType:"HTML5SDK",AppUri:"//",ApplicationID:"APP_SHELL_MY_REW",Description:"MEWR",ImageId:"",Name:"MyDSDnt",SecretKey:"c23cc2d146e3f3b704adf132a8573163",__osHeaders:{},col:0,iconUrl:"http://jamesgmailcom.space.duoworld.com/devportal/appicons/APP_SHELL_MY_ACCOUNT.png",row:1},{$$hashKey:"object:57",AppType:"HTML5SDK",AppUri:"//",ApplicationID:"APP_SHELL_MY_REW",Description:"MEWrR",ImageId:"",Name:"MyDSDtrnt",SecretKey:"c23cc2d146e3f3b704adf132a8573163",__osHeaders:{},col:0,iconUrl:"http://jamesgmailcom.space.duoworld.com/devportal/appicons/APP_SHELL_MY_ACCOUNT.png",row:1}]}],e.showGlobalProgress=!1,o.makeSwitchTennant=function(e,o){var n=c.confirm().title("Tennant switch confirm.").content('Are you sure you want to switch to "'+e+'" ?').ariaLabel("Switch Tennant").ok("Yes go ahead !").cancel("Dont do it").targetEvent(o);c.show(n).then(function(){window.open("http://"+e,"_blank")},function(){})}};e.$inject=["$rootScope","$scope","$state","$http","$location","$mdSidenav","$mdDialog","$mdToast","$presence","$auth","$apps","$v6urls","$helpers","$objectstore","$timeout","$fws","$document","$q","$storage"],mambatiFrameworkShell.controller("duoworld-framework-shell-ctrl",e)}();
